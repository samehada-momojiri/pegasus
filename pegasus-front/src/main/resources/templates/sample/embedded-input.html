<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="layouts/embedded-layout">
<body>
	<div layout:fragment="content">
		<div th:replace="components/userForm :: load(
				userForm = ${userForm}, 
				sexMap = ${sexMap}, 
				authorityMap = ${authorityMap}, 
				availableFunctionMap = ${availableFunctionMap})">
		</div>
		<script type="text/javascript">
			$(function () {
				$('#userForm').submit(function (event) {
					// HTMLでの送信をキャンセル
					event.preventDefault();
					// 操作対象のフォーム要素を取得
					var $form = $(this);

					$("#overlay").fadeIn(300);

					// 送信
					$.ajax({
						url: $form.attr('action'),
						type: $form.attr('method'),
						dataType: "html",
						data: $form.serialize(),

						// 通信成功時の処理
						success: function (result, textStatus, xhr) {
							//alert(result);
							$("#embeddedContainer").html(result);

							$("#overlay").fadeOut(300);
						},

						// 通信失敗時の処理
						error: function (xhr, textStatus, error) {
							alert('NG...');

							$("#overlay").fadeOut(300);
						}
					});
				});
			});	
		</script>
	</div>
</body>

</html>